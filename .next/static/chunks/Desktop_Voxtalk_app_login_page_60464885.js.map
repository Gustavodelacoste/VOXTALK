{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Kaue/Desktop/Voxtalk/app/login/page.js"],"sourcesContent":["\"use client\";\r\nimport { useState } from \"react\";\r\nimport { auth, db } from \"../firebase\";\r\nimport { signInWithEmailAndPassword, createUserWithEmailAndPassword, updateProfile } from \"firebase/auth\";\r\nimport { doc, setDoc, getDocs, collection, query, where } from \"firebase/firestore\";\r\n\r\nexport default function Login() {\r\n  const [email, setEmail] = useState(\"\");\r\n  const [password, setPassword] = useState(\"\");\r\n  const [name, setName] = useState(\"\");\r\n  const [nametag, setNametag] = useState(\"\");\r\n  const [isRegister, setIsRegister] = useState(false);\r\n\r\n  const handleLogin = async () => {\r\n    try {\r\n      await signInWithEmailAndPassword(auth, email, password);\r\n      window.location.href = \"/chat\";\r\n    } catch (e) {\r\n      alert(e.message);\r\n    }\r\n  };\r\n\r\n  const generateUniqueNametag = async (base) => {\r\n    const usersRef = collection(db, \"users\");\r\n    let tag = base;\r\n    let counter = 1;\r\n    while (true) {\r\n      const q = query(usersRef, where(\"nametag\", \"==\", tag));\r\n      const snapshot = await getDocs(q);\r\n      if (snapshot.empty) break;\r\n      tag = `${base}#${counter}`;\r\n      counter++;\r\n    }\r\n    return tag;\r\n  };\r\n\r\n  const handleRegister = async () => {\r\n    if (!nametag) {\r\n      alert(\"Digite uma nametag\");\r\n      return;\r\n    }\r\n    try {\r\n      const userCredential = await createUserWithEmailAndPassword(auth, email, password);\r\n      const finalNametag = await generateUniqueNametag(nametag);\r\n      await updateProfile(userCredential.user, { displayName: name, photoURL: \"\" });\r\n      await setDoc(doc(db, \"users\", userCredential.user.uid), {\r\n        uid: userCredential.user.uid,\r\n        name,\r\n        email,\r\n        photoURL: \"\",\r\n        nametag: finalNametag\r\n      });\r\n      window.location.href = \"/chat\";\r\n    } catch (e) {\r\n      alert(e.message);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div style={{ display:\"flex\", justifyContent:\"center\", alignItems:\"center\", height:\"100vh\", flexDirection:\"column\", background:\"#f2f2f2\" }}>\r\n      <h2>{isRegister ? \"Cadastro\" : \"Login\"}</h2>\r\n      {isRegister && <>\r\n        <input placeholder=\"Nome\" value={name} onChange={e=>setName(e.target.value)} style={inputStyle}/>\r\n        <input placeholder=\"Nametag\" value={nametag} onChange={e=>setNametag(e.target.value)} style={inputStyle}/>\r\n      </>}\r\n      <input placeholder=\"Email\" value={email} onChange={e=>setEmail(e.target.value)} style={inputStyle}/>\r\n      <input placeholder=\"Senha\" type=\"password\" value={password} onChange={e=>setPassword(e.target.value)} style={inputStyle}/>\r\n      <button onClick={isRegister ? handleRegister : handleLogin} style={buttonStyle}>\r\n        {isRegister ? \"Registrar\" : \"Entrar\"}\r\n      </button>\r\n      <p style={{ cursor:\"pointer\", color:\"blue\" }} onClick={()=>setIsRegister(!isRegister)}>\r\n        {isRegister ? \"Já tem conta? Login\" : \"Não tem conta? Registrar\"}\r\n      </p>\r\n    </div>\r\n  );\r\n}\r\n\r\nconst inputStyle = { margin:\"5px\", padding:\"8px\", borderRadius:\"8px\", border:\"1px solid #ccc\", width:\"250px\" };\r\nconst buttonStyle = { padding:\"8px 12px\", margin:\"5px\", borderRadius:\"8px\", border:\"none\", background:\"#4caf50\", color:\"#fff\", cursor:\"pointer\" };\r\n"],"names":[],"mappings":"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","debugId":null}}]
}